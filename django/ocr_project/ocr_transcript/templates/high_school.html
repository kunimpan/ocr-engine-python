{% extends "base.html" %}

{% block title %}
    <title>‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤ TSR</title>
{% endblock title %}

{% block content %}
<div class="container mt-4">
    <h3 class="text-center">üìÑ ‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡∏õ‡∏•‡∏≤‡∏¢</h3>

    <!-- Form Upload -->
    <div class="card shadow p-3 mb-4">
        <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="input-group">
                <label class="input-group-text" for="inputGroupFile01">üìé ‡πÉ‡∏ö‡∏ó‡∏£‡∏≤‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå</label>
                <input type="file" class="form-control" id="inputGroupFile01" name="file_uploads" multiple>
                <button class="btn btn-success" type="submit">üì§ ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î</button>
            </div>
        </form>
    </div>

    <!-- Messages Alert -->
    {% if messages %}
        <div class="alert-container">
            {% for message in messages %}
                <div class="alert 
                    {% if message.tags == 'success' %}alert-success
                    {% elif message.tags == 'warning' %}alert-warning
                    {% elif message.tags == 'error' %}alert-danger
                    {% else %}alert-secondary
                    {% endif %}" role="alert">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- ‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î -->
    {% if saved_images %}
    <div class="card shadow p-3 mb-4">
        <h4 class="text-center">üñºÔ∏è ‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</h4>
        <div class="d-flex flex-wrap justify-content-center">
            {% for image_url in saved_images %}
            <div class="text-center m-3">
                <a href="{{ image_url }}" target="_blank">
                    <img src="{{ image_url }}" alt="Uploaded Image" class="img-fluid rounded shadow" style="width: 150px; height: auto;">
                </a>
                <p class="mt-2">
                    <a href="{{ image_url }}" target="_blank" class="btn btn-outline-primary btn-sm">üîç ‡∏î‡∏π‡∏†‡∏≤‡∏û‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏ï‡πá‡∏°</a>
                </p>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î JSON -->
    {% if json_url %}
    <div class="text-center mb-4">
        <a href="{% url 'download_json' %}" class="btn btn-primary">
            üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î JSON
        </a>
    </div>
    {% endif %}

    <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ -->
    {% if student_name %}
    <div class="card shadow p-3 mb-4">
        <h4 class="text-center">üë®‚Äçüéì ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h4>
        <ul class="list-group list-group-flush">
            <li class="list-group-item"><b>‡∏ä‡∏∑‡πà‡∏≠:</b> {{ student_name }}</li>
            <li class="list-group-item"><b>‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</b> {{ student_lastname }}</li>
            <li class="list-group-item"><b>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Å‡∏¥‡∏ï‡∏£‡∏ß‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå:</b> {{ math_credits }}</li>
            <li class="list-group-item"><b>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏ß‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå:</b> {{ math_grade }}</li>
            <li class="list-group-item"><b>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Å‡∏¥‡∏ï‡∏£‡∏ß‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå:</b> {{ science_credits }}</li>
            <li class="list-group-item"><b>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏ß‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå:</b> {{ science_grade }}</li>
            <li class="list-group-item"><b>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏™‡∏∞‡∏™‡∏° (GPA):</b> {{ gpa }}</li>
        </ul>
    </div>
    {% endif %}

    <!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô -->
    {% if combined_list %}
    <div class="card shadow p-3 mb-4">
        <h4 class="text-center">üìö ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤</h4>
        <div class="table-responsive">
            <table class="table table-bordered text-center">
                <thead class="table-dark">
                    <tr>
                        <th scope="col">‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏¥‡∏ä‡∏≤</th>
                        <th scope="col">‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤</th>
                        <th scope="col">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Å‡∏¥‡∏ï</th>
                        <th scope="col">‡πÄ‡∏Å‡∏£‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ</th>
                    </tr>
                </thead>
                <tbody>
                    {% for subject_code, subject_name, credit, grade in combined_list %}
                    <tr>
                        <td>{{ subject_code }}</td>
                        <td>{{ subject_name }}</td>
                        <td>{{ credit }}</td>
                        <td>{{ grade }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}

</div> <!-- container -->
{% endblock content %}
